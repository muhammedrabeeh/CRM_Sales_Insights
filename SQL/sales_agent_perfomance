-- 5. SALES AGENT PERFORMANCE


## Revenue by Sales Agent#

SELECT 
    sales_agent, 
    SUM(close_value) AS revenue
FROM sales_pipeline_clean
GROUP BY sales_agent
ORDER BY revenue DESC;

## Revenue by Agent & Sector#

SELECT 
    a.sector,
    s.sales_agent,
    SUM(s.close_value) AS revenue
FROM sales_pipeline_clean s
JOIN accounts a
    ON s.account = a.account
GROUP BY s.sales_agent, a.sector
ORDER BY revenue DESC;

## Closed Deals & Win Rate by Agent#

SELECT 
    sales_agent,
    COUNT(*) AS closed_deals,
    AVG(deal_status) AS win_rate
FROM sales_pipeline_clean
WHERE deal_status IS NOT NULL
GROUP BY sales_agent
ORDER BY closed_deals DESC;

